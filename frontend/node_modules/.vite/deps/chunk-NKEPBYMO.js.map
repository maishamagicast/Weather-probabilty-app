{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{Float3PassUniform as o}from\"../../shaderModules/Float3PassUniform.js\";import{Float4PassUniform as e}from\"../../shaderModules/Float4PassUniform.js\";import{Float4sPassUniform as r}from\"../../shaderModules/Float4sPassUniform.js\";import{FloatsPassUniform as v}from\"../../shaderModules/FloatsPassUniform.js\";import{glsl as t}from\"../../shaderModules/glsl.js\";import{Matrix3PassUniform as a}from\"../../shaderModules/Matrix3PassUniform.js\";import{VertexAttribute as i}from\"../../../lib/VertexAttribute.js\";import{vvColorNumber as l}from\"../../../materials/VisualVariablePassParameters.js\";function n(n,s){const{vertex:u,attributes:c}=n;s.hasVvInstancing&&(s.vvSize||s.vvColor)&&c.add(i.INSTANCEFEATUREATTRIBUTE,\"vec4\"),s.vvSize?(u.uniforms.add(new o(\"vvSizeMinSize\",(o=>o.vvSize.minSize))),u.uniforms.add(new o(\"vvSizeMaxSize\",(o=>o.vvSize.maxSize))),u.uniforms.add(new o(\"vvSizeOffset\",(o=>o.vvSize.offset))),u.uniforms.add(new o(\"vvSizeFactor\",(o=>o.vvSize.factor))),u.uniforms.add(new o(\"vvSizeFallback\",(o=>o.vvSize.fallback))),u.uniforms.add(new a(\"vvSymbolRotationMatrix\",(o=>o.vvSymbolRotationMatrix))),u.uniforms.add(new o(\"vvSymbolAnchor\",(o=>o.vvSymbolAnchor))),u.code.add(t`vec3 vvScale(vec4 _featureAttribute) {\nif (isnan(_featureAttribute.x)) {\nreturn vvSizeFallback;\n}\nreturn clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n}\nvec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\nreturn vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n}`),u.code.add(t`\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 scale = max(vvScale(_featureAttribute), eps);\n        return vec4(vvSymbolRotationMatrix * _normal / scale, 1.0);\n      }\n\n      ${s.hasVvInstancing?t`\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }`:\"\"}\n    `)):u.code.add(t`vec4 localPosition() { return vec4(position, 1.0); }\nvec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),s.vvColor?(u.constants.add(\"vvColorNumber\",\"int\",l),u.uniforms.add(new v(\"vvColorValues\",(o=>o.vvColor.values),l),new r(\"vvColorColors\",(o=>o.vvColor.colors),l),new e(\"vvColorFallback\",(o=>o.vvColor.fallback))),u.code.add(t`\n      vec4 interpolateVVColor(float value) {\n        if (isnan(value)) {\n          return vvColorFallback;\n        }\n\n        if (value <= vvColorValues[0]) {\n          return vvColorColors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (vvColorValues[i] >= value) {\n            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n            return mix(vvColorColors[i-1], vvColorColors[i], f);\n          }\n        }\n        return vvColorColors[vvColorNumber - 1];\n      }\n\n      vec4 vvGetColor(vec4 featureAttribute) {\n        return interpolateVVColor(featureAttribute.y);\n      }\n\n      ${s.hasVvInstancing?t`\n            vec4 vvColor() {\n              return vvGetColor(instanceFeatureAttribute);\n            }`:\"vec4 vvColor() { return vec4(1.0); }\"}\n    `)):u.code.add(t`vec4 vvColor() { return vec4(1.0); }`)}export{n as VisualVariables};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;AAI6kB,SAASA,GAAEA,IAAEC,IAAE;AAAC,QAAK,EAAC,QAAO,GAAE,YAAW,EAAC,IAAED;AAAE,EAAAC,GAAE,oBAAkBA,GAAE,UAAQA,GAAE,YAAU,EAAE,IAAI,EAAE,0BAAyB,MAAM,GAAEA,GAAE,UAAQ,EAAE,SAAS,IAAI,IAAIC,GAAE,kBAAiB,CAAAC,OAAGA,GAAE,OAAO,QAAQ,CAAC,GAAE,EAAE,SAAS,IAAI,IAAID,GAAE,kBAAiB,CAAAC,OAAGA,GAAE,OAAO,QAAQ,CAAC,GAAE,EAAE,SAAS,IAAI,IAAID,GAAE,iBAAgB,CAAAC,OAAGA,GAAE,OAAO,OAAO,CAAC,GAAE,EAAE,SAAS,IAAI,IAAID,GAAE,iBAAgB,CAAAC,OAAGA,GAAE,OAAO,OAAO,CAAC,GAAE,EAAE,SAAS,IAAI,IAAID,GAAE,mBAAkB,CAAAC,OAAGA,GAAE,OAAO,SAAS,CAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,2BAA0B,CAAAA,OAAGA,GAAE,uBAAuB,CAAC,GAAE,EAAE,SAAS,IAAI,IAAID,GAAE,mBAAkB,CAAAC,OAAGA,GAAE,eAAe,CAAC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQ7pC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOPF,GAAE,kBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAOjB,EAAE;AAAA,KACN,KAAG,EAAE,KAAK,IAAI;AAAA,gEAC6C,GAAEA,GAAE,WAAS,EAAE,UAAU,IAAI,iBAAgB,OAAMC,EAAC,GAAE,EAAE,SAAS,IAAI,IAAI,EAAE,kBAAiB,CAAAC,OAAGA,GAAE,QAAQ,SAAQD,EAAC,GAAE,IAAIA,GAAE,kBAAiB,CAAAC,OAAGA,GAAE,QAAQ,SAAQD,EAAC,GAAE,IAAIA,GAAE,oBAAmB,CAAAC,OAAGA,GAAE,QAAQ,SAAS,CAAC,GAAE,EAAE,KAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAuBxRF,GAAE,kBAAgB;AAAA;AAAA;AAAA,iBAGX,sCAAsC;AAAA,KAChD,KAAG,EAAE,KAAK,IAAI,uCAAuC;AAAC;",
  "names": ["n", "s", "e", "o"]
}
